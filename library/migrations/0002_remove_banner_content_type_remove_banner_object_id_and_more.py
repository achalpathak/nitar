# Generated by Django 4.1.3 on 2022-11-27 12:30

from django.db import migrations, models
import library.models
import library.utils


class Migration(migrations.Migration):

    dependencies = [
        ("library", "0001_initial"),
    ]

    def insertData(apps, schema_editor):
        import urllib.request
        from django.core.files import File

        banner_urls = [
            urllib.request.urlretrieve(
                "https://ullu2-files.ullu.app/media-metadata/637f6b41a83dbd0bc0dd7afc"
            ),
            urllib.request.urlretrieve(
                "https://ullu2-files.ullu.app/media-metadata/637b639cb029cf0bf2d537dc"
            ),
            urllib.request.urlretrieve(
                "https://ullu2-files.ullu.app/media-metadata/637637d16daa370bc67a0161"
            ),
        ]
        welcome_urls = urllib.request.urlretrieve(
            "https://ullu2-files.ullu.app/media-metadata/6372630371844a0bd5f5500a"
        )
        Banner = apps.get_model("library", "Banner")

        for idx in banner_urls:
            obj = Banner(
                website_banner=File(open(idx[0], "rb")),
                mobile_banner=File(open(idx[0], "rb")),
                banner_type="Banner Default",
                url="big-ullu-movie",
                url_type="INTERNAL",
                published=True,
            )
            obj.save()
        obj = Banner(
            website_banner=File(open(welcome_urls[0], "rb")),
            mobile_banner=File(open(welcome_urls[0], "rb")),
            banner_type="Banner Welcome",
            url="https://www.google.com",
            url_type="EXTERNAL",
            published=True,
        )
        obj.save()

    operations = [
        migrations.RemoveField(
            model_name="banner",
            name="content_type",
        ),
        migrations.RemoveField(
            model_name="banner",
            name="object_id",
        ),
        migrations.AddField(
            model_name="banner",
            name="mobile_banner",
            field=models.ImageField(
                blank=True,
                help_text="Max image size should be 512 kB",
                null=True,
                upload_to=library.utils.image_path,
                validators=[library.models.validate_poster_small_vertical_image],
            ),
        ),
        migrations.AddField(
            model_name="banner",
            name="url_type",
            field=models.CharField(
                choices=[("INTERNAL", "INTERNAL"), ("EXTERNAL", "EXTERNAL")],
                default="EXTERNAL",
                max_length=25,
            ),
        ),
        migrations.AddField(
            model_name="banner",
            name="website_banner",
            field=models.ImageField(
                blank=True,
                help_text="Max image size should be 512 kB",
                null=True,
                upload_to=library.utils.image_path,
                validators=[library.models.validate_poster_small_vertical_image],
            ),
        ),
        migrations.AlterField(
            model_name="banner",
            name="url",
            field=models.CharField(
                help_text="NOTE: Enter SLUG value if url is internal.", max_length=255
            ),
        ),
        migrations.RunPython(insertData),
    ]
